!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).secp256k1=e()}(function(){return function n(i,o,a){function s(t,e){if(!o[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=o[t]={exports:{}},i[t][0].call(r.exports,function(e){return s(i[t][1][e]||e)},r,r.exports,n,i,o,a)}return o[t].exports}for(var u="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getHash=a,r.createCurve=function(t,e){var r=e=>(0,o.weierstrass)({...t,...a(e)});return Object.freeze({...r(e),create:r})};let n=e("@noble/hashes/hmac"),i=e("@noble/hashes/utils"),o=e("./abstract/weierstrass.js");function a(r){return{hash:r,hmac:(e,...t)=>(0,n.hmac)(r,e,(0,i.concatBytes)(...t)),randomBytes:i.randomBytes}}},{"./abstract/weierstrass.js":6,"@noble/hashes/hmac":10,"@noble/hashes/utils":12}],2:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.wNAF=function(w,y){return{constTimeNegate:b,hasPrecomputes(e){return 1!==a(e)},unsafeLadder(e,t,r=w.ZERO){let n=e;for(;t>l;)t&g&&(r=r.add(n)),n=n.double(),t>>=g;return r},precomputeWindow(e,t){var{windows:r,windowSize:n}=m(t,y),i=[];let o=e,a=o;for(let e=0;e<r;e++){a=o,i.push(a);for(let e=1;e<n;e++)a=a.add(o),i.push(a);o=a.double()}return i},wNAF(e,r,n){var{windows:i,windowSize:o}=m(e,y);let a=w.ZERO,s=w.BASE;var u=BigInt(2**e-1),f=2**e,l=BigInt(e);for(let t=0;t<i;t++){var d=t*o;let e=Number(n&u);n>>=l,e>o&&(e-=f,n+=g);var c=d,d=d+Math.abs(e)-1,h=t%2!=0,p=e<0;0===e?s=s.add(b(h,r[c])):a=a.add(b(p,r[d]))}return{p:a,f:s}},wNAFUnsafe(e,r,n,i=w.ZERO){var{windows:t,windowSize:o}=m(e,y),a=BigInt(2**e-1),s=2**e,u=BigInt(e);for(let e=0;e<t;e++){var f=e*o;if(n===l)break;let t=Number(n&a);if(n>>=u,t>o&&(t-=s,n+=g),0!==t){let e=r[f+Math.abs(t)-1];t<0&&(e=e.negate()),i=i.add(e)}}return i},getPrecomputes(e,t,r){let n=i.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&i.set(t,r(n))),n},wNAFCached(e,t,r){var n=a(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){var i=a(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,t){c(t,y),o.set(e,t),i.delete(e)}}},r.pippenger=function(e,t,i,o){if(p(i,e),w(o,t),i.length!==o.length)throw new Error("arrays of points and scalars must have equal length");let a=e.ZERO,r=(0,h.bitLen)(BigInt(i.length)),s=12<r?r-3:4<r?r-2:r?2:1,u=(1<<s)-1,f=new Array(1+u).fill(a),l=Math.floor((t.BITS-1)/s)*s,d=a;for(let n=l;0<=n;n-=s){f.fill(a);for(let t=0;t<o.length;t++){var c=o[t];let e=Number(c>>BigInt(n)&BigInt(u));f[e]=f[e].add(i[t])}let r=a;for(let e=f.length-1,t=a;0<e;e--)t=t.add(f[e]),r=r.add(t);if(d=d.add(r),0!==n)for(let e=0;e<s;e++)d=d.double()}return d},r.precomputeMSMUnsafe=function(e,o,a,s){c(s,o.BITS),p(a,e);let u=e.ZERO,i=2**s-1,f=Math.ceil(o.BITS/s),l=BigInt((1<<s)-1),d=a.map(r=>{var n=[];for(let e=0,t=r;e<i;e++)n.push(t),t=t.add(r);return n});return t=>{if(w(t,o),t.length>a.length)throw new Error("array of scalars must be smaller than array of points");let r=u;for(let e=0;e<f;e++){if(r!==u)for(let e=0;e<s;e++)r=r.double();var n=BigInt(f*s-(e+1)*s);for(let e=0;e<t.length;e++){var i=t[e],i=Number(i>>n&l);i&&(r=r.add(d[e][i-1]))}}return r}},r.validateBasic=function(e){return(0,n.validateField)(e.Fp),(0,h.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,n.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})};let n=e("./modular.js"),h=e("./utils.js"),l=BigInt(0),g=BigInt(1);function b(e,t){var r=t.negate();return e?r:t}function c(e,t){if(!Number.isSafeInteger(e)||e<=0||t<e)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function m(e,t){return c(e,t),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}function p(e,r){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,t)=>{if(!(e instanceof r))throw new Error("invalid point at index "+t)})}function w(e,r){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,t)=>{if(!r.isValid(e))throw new Error("invalid scalar at index "+t)})}let i=new WeakMap,o=new WeakMap;function a(e){return o.get(e)||1}},{"./modular.js":4,"./utils.js":5}],3:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.expand_message_xmd=b,r.expand_message_xof=m,r.hash_to_field=o,r.isogenyMap=function(a,e){let s=e.map(e=>Array.from(e).reverse());return(r,e)=>{var[t,n,i,o]=s.map(e=>e.reduce((e,t)=>a.add(a.mul(e,r),t)));return r=a.div(t,n),e=a.mul(e,a.div(i,o)),{x:r,y:e}}},r.createHasher=function(r,n,i){if("function"!=typeof n)throw new Error("mapToCurve() must be defined");return{hashToCurve(e,t){e=o(e,2,{...i,DST:i.DST,...t}),t=r.fromAffine(n(e[0])),e=r.fromAffine(n(e[1])),t=t.add(e).clearCofactor();return t.assertValidity(),t},encodeToCurve(e,t){e=o(e,1,{...i,DST:i.encodeDST,...t}),t=r.fromAffine(n(e[0])).clearCofactor();return t.assertValidity(),t},mapToCurve(e){if(!Array.isArray(e))throw new Error("mapToCurve: expected array of bigints");for(var t of e)if("bigint"!=typeof t)throw new Error("mapToCurve: expected array of bigints");e=r.fromAffine(n(e)).clearCofactor();return e.assertValidity(),e}}};let p=e("./modular.js"),w=e("./utils.js"),y=w.bytesToNumberBE;function d(t,r){if(g(t),g(r),t<0||1<<8*r<=t)throw new Error("invalid I2OSP input: "+t);var n=Array.from({length:r}).fill(0);for(let e=r-1;0<=e;e--)n[e]=255&t,t>>>=8;return new Uint8Array(n)}function g(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function b(e,t,r,n){(0,w.abytes)(e),(0,w.abytes)(t),g(r),255<t.length&&(t=n((0,w.concatBytes)((0,w.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));var{outputLen:i,blockLen:o}=n,a=Math.ceil(r/i);if(65535<r||255<a)throw new Error("expand_message_xmd: invalid lenInBytes");var s=(0,w.concatBytes)(t,d(t.length,1)),i=d(0,o),t=d(r,2),u=new Array(a),f=n((0,w.concatBytes)(i,e,t,d(0,1),s));u[0]=n((0,w.concatBytes)(f,d(1,1),s));for(let e=1;e<=a;e++){var l=[((t,r)=>{var n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t[e]^r[e];return n})(f,u[e-1]),d(e+1,1),s];u[e]=n((0,w.concatBytes)(...l))}return(0,w.concatBytes)(...u).slice(0,r)}function m(e,t,r,n,i){if((0,w.abytes)(e),(0,w.abytes)(t),g(r),255<t.length&&(n=Math.ceil(2*n/8),t=i.create({dkLen:n}).update((0,w.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()),65535<r||255<t.length)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(e).update(d(r,2)).update(t).update(d(t.length,1)).digest()}function o(e,r,t){(0,w.validateObject)(t,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});var{p:n,k:t,m:i,hash:o,expand:a,DST:s}=t,s=((0,w.abytes)(e),g(r),"string"==typeof s?(0,w.utf8ToBytes)(s):s),u=n.toString(2).length,f=Math.ceil((u+t)/8),u=r*i*f;let l;if("xmd"===a)l=b(e,s,u,o);else if("xof"===a)l=m(e,s,u,t,o);else{if("_internal_pass"!==a)throw new Error('expand must be "xmd" or "xof"');l=e}var d=new Array(r);for(let t=0;t<r;t++){var c=new Array(i);for(let e=0;e<i;e++){var h=f*(e+t*i),h=l.subarray(h,h+f);c[e]=(0,p.mod)(y(h),n)}d[t]=c}return d}},{"./modular.js":4,"./utils.js":5}],4:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isNegativeLE=void 0,r.mod=d,r.pow=p,r.pow2=function(e,t,r){let n=e;for(;t-- >c;)n=(n*=n)%r;return n},r.invert=w,r.tonelliShanks=y,r.FpSqrt=g,r.validateField=function(e){var t=b.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return(0,u.validateObject)(e,t)},r.FpPow=m,r.FpInvertBatch=v,r.FpDiv=function(e,t,r){return e.mul(t,"bigint"==typeof r?w(r,e.ORDER):e.inv(r))},r.FpLegendre=E,r.FpIsSquare=function(t){let r=E(t.ORDER);return e=>{e=r(t,e);return t.eql(e,t.ZERO)||t.eql(e,t.ONE)}},r.nLength=B,r.Field=function(r,e,t=!1,n={}){if(r<=c)throw new Error("invalid field: expected ORDER > 0, got "+r);let{nBitLength:i,nByteLength:o}=B(r,e);if(2048<o)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let a,s=Object.freeze({ORDER:r,BITS:i,BYTES:o,MASK:(0,u.bitMask)(i),ZERO:c,ONE:h,create:e=>d(e,r),isValid:e=>{if("bigint"!=typeof e)throw new Error("invalid field element: expected bigint, got "+typeof e);return c<=e&&e<r},is0:e=>e===c,isOdd:e=>(e&h)===h,neg:e=>d(-e,r),eql:(e,t)=>e===t,sqr:e=>d(e*e,r),add:(e,t)=>d(e+t,r),sub:(e,t)=>d(e-t,r),mul:(e,t)=>d(e*t,r),pow:(e,t)=>m(s,e,t),div:(e,t)=>d(e*w(t,r),r),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:e=>w(e,r),sqrt:n.sqrt||(e=>(a=a||g(r))(s,e)),invertBatch:e=>v(s,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>(t?(0,u.numberToBytesLE):(0,u.numberToBytesBE))(e,o),fromBytes:e=>{if(e.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+e.length);return(t?(0,u.bytesToNumberLE):(0,u.bytesToNumberBE))(e)}});return Object.freeze(s)},r.FpSqrtOdd=function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");t=e.sqrt(t);return e.isOdd(t)?t:e.neg(t)},r.FpSqrtEven=function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");t=e.sqrt(t);return e.isOdd(t)?e.neg(t):t},r.hashToPrivateScalar=function(e,t,r=!1){var n=(e=(0,u.ensureBytes)("privateHash",e)).length,i=B(t).nByteLength+8;if(i<24||n<i||1024<n)throw new Error("hashToPrivateScalar: expected "+i+"-1024 bytes of input, got "+n);i=(r?(0,u.bytesToNumberLE):(0,u.bytesToNumberBE))(e);return d(i,t-h)+h},r.getFieldBytesLength=x,r.getMinHashLength=A,r.mapHashToField=function(e,t,r=!1){var n=e.length,i=x(t),o=A(t);if(n<16||n<o||1024<n)throw new Error("expected "+o+"-1024 bytes of input, got "+n);o=(r?(0,u.bytesToNumberBE):(0,u.bytesToNumberLE))(e),n=d(o,t-h)+h;return(r?(0,u.numberToBytesLE):(0,u.numberToBytesBE))(n,i)};let u=e("./utils.js"),c=BigInt(0),h=BigInt(1),o=BigInt(2),n=BigInt(3),i=BigInt(4),a=BigInt(5),s=BigInt(8),f=BigInt(9),l=BigInt(16);function d(e,t){e%=t;return e>=c?e:t+e}function p(e,t,r){if(t<c)throw new Error("invalid exponent, negatives unsupported");if(r<=c)throw new Error("invalid modulus");if(r===h)return c;let n=h;for(;t>c;)t&h&&(n=n*e%r),e=e*e%r,t>>=h;return n}function w(e,t){if(e===c)throw new Error("invert: expected non-zero number");if(t<=c)throw new Error("invert: expected positive modulus, got "+t);let r=d(e,t),n=t,i=c,o=h,a=h,s=c;for(;r!==c;){var u=n/r,f=n%r,l=i-a*u,u=o-s*u;n=r,r=f,i=a,o=s,a=l,s=u}if(n!==h)throw new Error("invert: does not exist");return d(i,t)}function y(e){let t=(e-h)/o,u,f,l;for(u=e-h,f=0;u%o===c;u/=o,f++);for(l=o;l<e&&p(l,t,e)!==e-h;l++)if(1e3<l)throw new Error("Cannot find square root: likely non-prime P");if(1===f){let n=(e+h)/i;return function(e,t){var r=e.pow(t,n);if(e.eql(e.sqr(r),t))return r;throw new Error("Cannot find square root")}}let d=(u+h)/o;return function(r,e){if(r.pow(e,t)===r.neg(r.ONE))throw new Error("Cannot find square root");let n=f,i=r.pow(r.mul(r.ONE,l),u),o=r.pow(e,d),a=r.pow(e,u);for(;!r.eql(a,r.ONE);){if(r.eql(a,r.ZERO))return r.ZERO;let t=1;for(let e=r.sqr(a);t<n&&!r.eql(e,r.ONE);t++)e=r.sqr(e);var s=r.pow(i,h<<BigInt(n-t-1));i=r.sqr(s),o=r.mul(o,s),a=r.mul(a,i),n=t}return o}}function g(e){if(e%i===n){let n=(e+h)/i;return function(e,t){var r=e.pow(t,n);if(e.eql(e.sqr(r),t))return r;throw new Error("Cannot find square root")}}if(e%s!==a)return l,f,y(e);{let i=(e-a)/s;return function(e,t){var r=e.mul(t,o),r=e.pow(r,i),n=e.mul(t,r),r=e.mul(e.mul(n,o),r),n=e.mul(n,e.sub(r,e.ONE));if(e.eql(e.sqr(n),t))return n;throw new Error("Cannot find square root")}}}r.isNegativeLE=(e,t)=>(d(e,t)&h)===h;let b=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function m(e,t,r){if(r<c)throw new Error("invalid exponent, negatives unsupported");if(r===c)return e.ONE;if(r===h)return t;let n=e.ONE,i=t;for(;r>c;)r&h&&(n=e.mul(n,i)),i=e.sqr(i),r>>=h;return n}function v(n,e){let i=new Array(e.length);var t=e.reduce((e,t,r)=>n.is0(t)?e:(i[r]=e,n.mul(e,t)),n.ONE),t=n.inv(t);return e.reduceRight((e,t,r)=>n.is0(t)?e:(i[r]=n.mul(e,i[r]),n.mul(e,t)),t),i}function E(e){let r=(e-h)/o;return(e,t)=>e.pow(t,r)}function B(e,t){t=void 0!==t?t:e.toString(2).length;return{nBitLength:t,nByteLength:Math.ceil(t/8)}}function x(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");e=e.toString(2).length;return Math.ceil(e/8)}function A(e){e=x(e);return e+Math.ceil(e/2)}},{"./utils.js":5}],5:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.notImplemented=r.bitMask=void 0,r.isBytes=a,r.abytes=s,r.abool=function(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)},r.bytesToHex=f,r.numberToHexUnpadded=l,r.hexToNumber=d,r.hexToBytes=p,r.bytesToNumberBE=function(e){return d(f(e))},r.bytesToNumberLE=function(e){return s(e),d(f(Uint8Array.from(e).reverse()))},r.numberToBytesBE=w,r.numberToBytesLE=function(e,t){return w(e,t).reverse()},r.numberToVarBytesBE=function(e){return p(l(e))},r.ensureBytes=function(t,e,r){let n;if("string"==typeof e)try{n=p(e)}catch(e){throw new Error(t+" must be hex string or Uint8Array, cause: "+e)}else{if(!a(e))throw new Error(t+" must be hex string or Uint8Array");n=Uint8Array.from(e)}e=n.length;if("number"==typeof r&&e!==r)throw new Error(t+" of length "+r+" expected, got "+e);return n},r.concatBytes=y,r.equalBytes=function(t,r){if(t.length!==r.length)return!1;let n=0;for(let e=0;e<t.length;e++)n|=t[e]^r[e];return 0===n},r.utf8ToBytes=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))},r.inRange=b,r.aInRange=function(e,t,r,n){if(!b(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)},r.bitLen=function(e){let t;for(t=0;e>n;e>>=i,t+=1);return t},r.bitGet=function(e,t){return e>>BigInt(t)&i},r.bitSet=function(e,t,r){return e|(r?i:n)<<BigInt(t)},r.createHmacDrbg=function(e,n,t){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof n||n<2)throw new Error("qByteLen must be a number");if("function"!=typeof t)throw new Error("hmacFn must be a function");let i=m(e),r=m(e),o=0,a=()=>{i.fill(1),r.fill(0),o=0},s=(...e)=>t(r,i,...e),u=(e=m())=>{r=s(v([0]),e),i=s(),0!==e.length&&(r=s(v([1]),e),i=s())},f=(e,t)=>{a(),u(e);let r=void 0;for(;!(r=t((()=>{if(1e3<=o++)throw new Error("drbg: tried 1000 values");let e=0;for(var t=[];e<n;){var r=(i=s()).slice();t.push(r),e+=i.length}return y(...t)})()));)u();return a(),r};return f},r.validateObject=function(o,e,t={}){var r=(e,t,r)=>{var n=E[t];if("function"!=typeof n)throw new Error("invalid validator function");var i=o[e];if(!(r&&void 0===i||n(i,o)))throw new Error("param "+String(e)+" is invalid. Expected "+t+", got "+i)};for(var[n,i]of Object.entries(e))r(n,i,!1);for(var[a,s]of Object.entries(t))r(a,s,!0);return o},r.memoized=function(n){let i=new WeakMap;return(e,...t)=>{var r=i.get(e);return void 0!==r||(r=n(e,...t),i.set(e,r)),r}};let n=BigInt(0),i=BigInt(1),o=BigInt(2);function a(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function s(e){if(!a(e))throw new Error("Uint8Array expected")}let u=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function f(t){s(t);let r="";for(let e=0;e<t.length;e++)r+=u[t[e]];return r}function l(e){e=e.toString(16);return 1&e.length?"0"+e:e}function d(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?n:BigInt("0x"+e)}let c={_0:48,_9:57,A:65,F:70,a:97,f:102};function h(e){return e>=c._0&&e<=c._9?e-c._0:e>=c.A&&e<=c.F?e-(c.A-10):e>=c.a&&e<=c.f?e-(c.a-10):void 0}function p(r){if("string"!=typeof r)throw new Error("hex string expected, got "+typeof r);var e=r.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);var i=new Uint8Array(n);for(let e=0,t=0;e<n;e++,t+=2){var o,a=h(r.charCodeAt(t)),s=h(r.charCodeAt(t+1));if(void 0===a||void 0===s)throw o=r[t]+r[t+1],new Error('hex string expected, got non-hex character "'+o+'" at index '+t);i[e]=16*a+s}return i}function w(e,t){return p(e.toString(16).padStart(2*t,"0"))}function y(...r){let t=0;for(let e=0;e<r.length;e++){var n=r[e];s(n),t+=n.length}var i=new Uint8Array(t);for(let e=0,t=0;e<r.length;e++){var o=r[e];i.set(o,t),t+=o.length}return i}let g=e=>"bigint"==typeof e&&n<=e;function b(e,t,r){return g(e)&&g(t)&&g(r)&&t<=e&&e<r}r.bitMask=e=>(o<<BigInt(e-1))-i;let m=e=>new Uint8Array(e),v=e=>Uint8Array.from(e);let E={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||a(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};r.notImplemented=()=>{throw new Error("not implemented")}},{}],6:[function(e,t,A){Object.defineProperty(A,"__esModule",{value:!0}),A.DER=void 0,A.weierstrassPoints=k,A.weierstrass=function(e){let l=(e=>(e=(0,S.validateBasic)(e),T.validateObject(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})))(e),{Fp:d,n:t}=l,a=d.BYTES+1,s=2*d.BYTES+1;function c(e){return O.mod(e,t)}function h(e){return O.invert(e,t)}let{ProjectivePoint:p,normPrivateKeyToScalar:w,weierstrassEquation:u,isWithinCurveOrder:y}=k({...l,toBytes(e,t,r){var n=t.toAffine(),i=d.toBytes(n.x),o=T.concatBytes;return(0,I.abool)("isCompressed",r),r?o(Uint8Array.from([t.hasEvenY()?2:3]),i):o(Uint8Array.from([4]),i,d.toBytes(n.y))},fromBytes(t){var r=t.length,n=t[0],t=t.subarray(1);if(r!==a||2!==n&&3!==n){if(r===s&&4===n)return{x:d.fromBytes(t.subarray(0,d.BYTES)),y:d.fromBytes(t.subarray(d.BYTES,2*d.BYTES))};throw i=a,o=s,new Error("invalid Point, expected length of "+i+", or uncompressed "+o+", got "+r)}{var i=T.bytesToNumberBE(t);if(!T.inRange(i,L,d.ORDER))throw new Error("Point is not on curve");var o=u(i);let e;try{e=d.sqrt(o)}catch(e){r=e instanceof Error?": "+e.message:"";throw new Error("Point is not on curve"+r)}t=(e&L)===L;return{x:i,y:e=1==(1&n)!=t?d.neg(e):e}}}}),i=e=>T.bytesToHex(T.numberToBytesBE(e,l.nByteLength));function g(e){return t>>L<e}let r=(e,t,r)=>T.bytesToNumberBE(e.slice(t,r));class b{constructor(e,t,r){this.r=e,this.s=t,this.recovery=r,this.assertValidity()}static fromCompact(e){var t=l.nByteLength;return e=(0,I.ensureBytes)("compactSignature",e,2*t),new b(r(e,0,t),r(e,t,2*t))}static fromDER(e){var{r:e,s:t}=A.DER.toSig((0,I.ensureBytes)("DER",e));return new b(e,t)}assertValidity(){T.aInRange("r",this.r,L,t),T.aInRange("s",this.s,L,t)}addRecoveryBit(e){return new b(this.r,this.s,e)}recoverPublicKey(e){var{r:t,s:r,recovery:n}=this,e=v((0,I.ensureBytes)("msgHash",e));if(null==n||![0,1,2,3].includes(n))throw new Error("recovery id invalid");t=2===n||3===n?t+l.n:t;if(t>=d.ORDER)throw new Error("recovery id 2 or 3 invalid");n=0==(1&n)?"02":"03",n=p.fromHex(n+i(t)),t=h(t),e=c(-e*t),r=c(r*t),t=p.BASE.multiplyAndAddUnsafe(n,e,r);if(t)return t.assertValidity(),t;throw new Error("point at infinify")}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new b(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return T.hexToBytes(this.toDERHex())}toDERHex(){return A.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return T.hexToBytes(this.toCompactHex())}toCompactHex(){return i(this.r)+i(this.s)}}e={isValidPrivateKey(e){try{return w(e),!0}catch(e){return!1}},normPrivateKeyToScalar:w,randomPrivateKey:()=>{var e=O.getMinHashLength(l.n);return O.mapHashToField(l.randomBytes(e),l.n)},precompute(e=8,t=p.BASE){return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function n(e){var t=T.isBytes(e),r="string"==typeof e,n=(t||r)&&e.length;return t?n===a||n===s:r?n===2*a||n===2*s:e instanceof p}let m=l.bits2int||function(e){if(8192<e.length)throw new Error("input is too large");var t=T.bytesToNumberBE(e),e=8*e.length-l.nBitLength;return 0<e?t>>BigInt(e):t},v=l.bits2int_modN||function(e){return c(m(e))},o=T.bitMask(l.nBitLength);function E(e){return T.aInRange("num < 2^"+l.nBitLength,e,j,o),T.numberToBytesBE(e,l.nByteLength)}function f(e,t,r=B){if(["recovered","canonical"].some(e=>e in r))throw new Error("sign() legacy options not supported");var{hash:n,randomBytes:i}=l;let{lowS:o,prehash:a,extraEntropy:s}=r;null==o&&(o=!0),e=(0,I.ensureBytes)("msgHash",e),R(r),a&&(e=(0,I.ensureBytes)("prehashed msgHash",n(e)));n=v(e);let u=w(t);e=[E(u),E(n)],null!=s&&!1!==s&&(t=!0===s?i(d.BYTES):s,e.push((0,I.ensureBytes)("extraEntropy",t))),i=T.concatBytes(...e);let f=n;return{seed:i,k2sig:function(r){if(r=m(r),y(r)){var n=h(r),r=p.BASE.multiply(r).toAffine(),i=c(r.x);if(i!==j){n=c(n*c(f+i*u));if(n!==j){let e=(r.x===i?0:2)|Number(r.y&L),t=n;return o&&g(n)&&(t=g(r=n)?c(-r):r,e^=1),new b(i,t,e)}}}}}}let B={lowS:l.lowS,prehash:!1},x={lowS:l.lowS,prehash:!1};return p.BASE._setWindowSize(8),{CURVE:l,getPublicKey:function(e,t=!0){return p.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(n(e))throw new Error("first arg must be private key");if(n(t))return p.fromHex(t).multiply(w(e)).toRawBytes(r);throw new Error("second arg must be public key")},sign:function(e,t,r=B){var{seed:e,k2sig:t}=f(e,t,r),r=l;return T.createHmacDrbg(r.hash.outputLen,r.nByteLength,r.hmac)(e,t)},verify:function(e,t,r,n=x){t=(0,I.ensureBytes)("msgHash",t),r=(0,I.ensureBytes)("publicKey",r);var{lowS:i,prehash:o,format:a}=n;if(R(n),"strict"in n)throw new Error("options.strict was renamed to lowS");if(void 0!==a&&"compact"!==a&&"der"!==a)throw new Error("format must be compact or der");var s=!(n="string"==typeof e||T.isBytes(e))&&!a&&"object"==typeof e&&null!==e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!n&&!s)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let u=void 0,f;try{if(s&&(u=new b(e.r,e.s)),n){try{"compact"!==a&&(u=b.fromDER(e))}catch(e){if(!(e instanceof A.DER.Err))throw e}u||"der"===a||(u=b.fromCompact(e))}f=p.fromHex(r)}catch(e){return!1}if(!u)return!1;if(i&&u.hasHighS())return!1;o&&(t=l.hash(t));var{r:s,s:n}=u,a=v(t),e=h(n),r=c(a*e),i=c(s*e);return!!(o=p.BASE.multiplyAndAddUnsafe(f,r,i)?.toAffine())&&c(o.x)===s},ProjectivePoint:p,Signature:b,utils:e}},A.SWUFpSqrtRatio=n,A.mapToCurveSimpleSWU=function(s,u){if(O.validateField(s),!s.isValid(u.A)||!s.isValid(u.B)||!s.isValid(u.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let f=n(s,u.Z);if(s.isOdd)return e=>{var t,r=s.sqr(e),n=(r=s.mul(r,u.Z),o=s.sqr(r),o=s.add(o,r),a=s.add(o,s.ONE),a=s.mul(a,u.B),t=s.cmov(u.Z,s.neg(o),!s.eql(o,s.ZERO)),t=s.mul(t,u.A),o=s.sqr(a),n=s.sqr(t),i=s.mul(n,u.A),o=s.add(o,i),o=s.mul(o,a),s.mul(n,t)),i=s.mul(n,u.B),o=s.add(o,i),i=s.mul(r,a),{isValid:o,value:n}=f(o,n),r=s.mul(r,e),a=(r=s.mul(r,n),i=s.cmov(i,a,o),r=s.cmov(r,n,o),s.isOdd(e)===s.isOdd(r));return r=s.cmov(s.neg(r),r,a),{x:s.div(i,t),y:r}};throw new Error("Fp.isOdd is not implemented!")};let S=e("./curve.js"),O=e("./modular.js"),T=e("./utils.js"),I=e("./utils.js");function R(e){void 0!==e.lowS&&(0,I.abool)("lowS",e.lowS),void 0!==e.prehash&&(0,I.abool)("prehash",e.prehash)}let{bytesToNumberBE:r,hexToBytes:o}=T,j=(A.DER={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{var r=A.DER.Err;if(e<0||256<e)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");var n=t.length/2,i=T.numberToHexUnpadded(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");r=127<n?T.numberToHexUnpadded(i.length/2|128):"";return T.numberToHexUnpadded(e)+r+i+t},decode(e,t){var r=A.DER.Err;let n=0;if(e<0||256<e)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");e=t[n++];let i=0;if(!!(128&e)){var o=127&e;if(!o)throw new r("tlv.decode(long): indefinite length not supported");if(4<o)throw new r("tlv.decode(long): byte length is too big");var a,s=t.subarray(n,n+o);if(s.length!==o)throw new r("tlv.decode: length bytes not complete");if(0===s[0])throw new r("tlv.decode(long): zero leftmost byte");for(a of s)i=i<<8|a;if(n+=o,i<128)throw new r("tlv.decode(long): not minimal encoding")}else i=e;s=t.subarray(n,n+i);if(s.length!==i)throw new r("tlv.decode: wrong value length");return{v:s,l:t.subarray(n+i)}}},_int:{encode(e){var t=A.DER.Err;if(e<j)throw new t("integer: negative integers are not allowed");let r=T.numberToHexUnpadded(e);if(1&(r=8&Number.parseInt(r[0],16)?"00"+r:r).length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){var t=A.DER.Err;if(128&e[0])throw new t("invalid signature integer: negative");if(0!==e[0]||128&e[1])return r(e);throw new t("invalid signature integer: unnecessary leading zero")}},toSig(e){var{Err:t,_int:r,_tlv:n}=A.DER,e="string"==typeof e?o(e):e,{v:e,l:i}=(T.abytes(e),n.decode(48,e));if(i.length)throw new t("invalid signature: left bytes after parsing");var{v:i,l:e}=n.decode(2,e),{v:n,l:e}=n.decode(2,e);if(e.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(i),s:r.decode(n)}},hexFromSig(e){var{_tlv:t,_int:r}=A.DER,n=t.encode(2,r.encode(e.r)),r=t.encode(2,r.encode(e.s));return t.encode(48,n+r)}},BigInt(0)),L=BigInt(1),y=BigInt(2),g=BigInt(3),s=BigInt(4);function k(e){let h=(e=>{var e=(0,S.validateBasic)(e),{endo:t,Fp:r,a:n}=(T.validateObject(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"}),e);if(t){if(!r.eql(n,r.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof t||"bigint"!=typeof t.beta||"function"!=typeof t.splitScalar)throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})})(e),p=h.Fp,r=O.Field(h.n,h.nBitLength),t=h.toBytes||((e,t,r)=>{t=t.toAffine();return T.concatBytes(Uint8Array.from([4]),p.toBytes(t.x),p.toBytes(t.y))}),n=h.fromBytes||(e=>{e=e.subarray(1);return{x:p.fromBytes(e.subarray(0,p.BYTES)),y:p.fromBytes(e.subarray(p.BYTES,2*p.BYTES))}});function i(e){var{a:t,b:r}=h,n=p.sqr(e),n=p.mul(n,e);return p.add(p.add(n,p.mul(e,t)),r)}if(!p.eql(p.sqr(h.Gy),i(h.Gx)))throw new Error("bad generator point: equation left != right");function o(t){var{allowedPrivateKeyLengths:e,nByteLength:r,wrapPrivateKey:n,n:i}=h;if(e&&"bigint"!=typeof t){if("string"!=typeof(t=T.isBytes(t)?T.bytesToHex(t):t)||!e.includes(t.length))throw new Error("invalid private key");t=t.padStart(2*r,"0")}let o;try{o="bigint"==typeof t?t:T.bytesToNumberBE((0,I.ensureBytes)("private key",t,r))}catch(e){throw new Error("invalid private key, expected hex or "+r+" bytes, got "+typeof t)}return n&&(o=O.mod(o,i)),T.aInRange("private key",o,L,i),o}function w(e){if(!(e instanceof y))throw new Error("ProjectivePoint expected")}let a=(0,I.memoized)((e,t)=>{var{px:r,py:n,pz:i}=e;if(p.eql(i,p.ONE))return{x:r,y:n};e=e.is0(),null==t&&(t=e?p.ONE:p.inv(i)),r=p.mul(r,t),n=p.mul(n,t),i=p.mul(i,t);if(e)return{x:p.ZERO,y:p.ZERO};if(p.eql(i,p.ONE))return{x:r,y:n};throw new Error("invZ was invalid")}),s=(0,I.memoized)(e=>{if(e.is0()){if(h.allowInfinityPoint&&!p.is0(e.py))return;throw new Error("bad point: ZERO")}var{x:t,y:r}=e.toAffine();if(!p.isValid(t)||!p.isValid(r))throw new Error("bad point: x or y not FE");r=p.sqr(r),t=i(t);if(!p.eql(r,t))throw new Error("bad point: equation left != right");if(e.isTorsionFree())return!0;throw new Error("bad point: not in prime-order subgroup")});class y{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!p.isValid(e))throw new Error("x required");if(null==t||!p.isValid(t))throw new Error("y required");if(null==r||!p.isValid(r))throw new Error("z required");Object.freeze(this)}static fromAffine(e){var{x:t,y:r}=e||{};if(!e||!p.isValid(t)||!p.isValid(r))throw new Error("invalid affine point");if(e instanceof y)throw new Error("projective point not allowed");e=e=>p.eql(e,p.ZERO);return e(t)&&e(r)?y.ZERO:new y(t,r,p.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){let r=p.invertBatch(e.map(e=>e.pz));return e.map((e,t)=>e.toAffine(r[t])).map(y.fromAffine)}static fromHex(e){e=y.fromAffine(n((0,I.ensureBytes)("pointHex",e)));return e.assertValidity(),e}static fromPrivateKey(e){return y.BASE.multiply(o(e))}static msm(e,t){return(0,S.pippenger)(y,r,e,t)}_setWindowSize(e){l.setWindowSize(this,e)}assertValidity(){s(this)}hasEvenY(){var e=this.toAffine().y;if(p.isOdd)return!p.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){w(e);var{px:t,py:r,pz:n}=this,{px:e,py:i,pz:o}=e,t=p.eql(p.mul(t,o),p.mul(e,n)),e=p.eql(p.mul(r,o),p.mul(i,n));return t&&e}negate(){return new y(this.px,p.neg(this.py),this.pz)}double(){var e,t,{a:r,b:n}=h,n=p.mul(n,g),{px:i,py:o,pz:a}=this,s=(p.ZERO,p.ZERO,p.ZERO,p.mul(i,i)),u=p.mul(o,o),f=p.mul(a,a),l=p.mul(i,o),l=p.add(l,l),i=p.mul(i,a);return i=p.add(i,i),e=p.mul(r,i),t=p.mul(n,f),t=p.add(e,t),e=p.sub(u,t),t=p.add(u,t),t=p.mul(e,t),e=p.mul(l,e),i=p.mul(n,i),f=p.mul(r,f),l=p.sub(s,f),l=p.mul(r,l),l=p.add(l,i),i=p.add(s,s),s=p.add(i,s),s=p.add(s,f),s=p.mul(s,l),t=p.add(t,s),f=p.mul(o,a),f=p.add(f,f),s=p.mul(f,l),e=p.sub(e,s),i=p.mul(f,u),i=p.add(i,i),i=p.add(i,i),new y(e,t,i)}add(e){w(e);var{px:t,py:r,pz:n}=this,{px:e,py:i,pz:o}=e,a=(p.ZERO,p.ZERO,p.ZERO,h.a),s=p.mul(h.b,g),u=p.mul(t,e),f=p.mul(r,i),l=p.mul(n,o),d=p.add(t,r),c=p.add(e,i),d=p.mul(d,c),c=p.add(u,f),t=(d=p.sub(d,c),c=p.add(t,n),p.add(e,o));return c=p.mul(c,t),t=p.add(u,l),c=p.sub(c,t),t=p.add(r,n),e=p.add(i,o),t=p.mul(t,e),e=p.add(f,l),t=p.sub(t,e),r=p.mul(a,c),e=p.mul(s,l),r=p.add(e,r),e=p.sub(f,r),r=p.add(f,r),n=p.mul(e,r),f=p.add(u,u),f=p.add(f,u),l=p.mul(a,l),c=p.mul(s,c),f=p.add(f,l),l=p.sub(u,l),l=p.mul(a,l),c=p.add(c,l),u=p.mul(f,c),n=p.add(n,u),u=p.mul(t,c),e=p.mul(d,e),e=p.sub(e,u),u=p.mul(d,f),r=p.mul(t,r),r=p.add(r,u),new y(e,n,r)}subtract(e){return this.add(e.negate())}is0(){return this.equals(y.ZERO)}wNAF(e){return l.wNAFCached(this,e,y.normalizeZ)}multiplyUnsafe(e){var{endo:t,n:r}=h,r=(T.aInRange("scalar",e,j,r),y.ZERO);if(e===j)return r;if(this.is0()||e===L)return this;if(!t||l.hasPrecomputes(this))return l.wNAFCachedUnsafe(this,e,y.normalizeZ);let{k1neg:n,k1:i,k2neg:o,k2:a}=t.splitScalar(e),s=r,u=r,f=this;for(;i>j||a>j;)i&L&&(s=s.add(f)),a&L&&(u=u.add(f)),f=f.double(),i>>=L,a>>=L;return n&&(s=s.negate()),o&&(u=u.negate()),u=new y(p.mul(u.px,t.beta),u.py,u.pz),s.add(u)}multiply(e){var t,r,n,i,o,{endo:a,n:s}=h;T.aInRange("scalar",e,L,s);let u,f;return f=a?({k1neg:s,k1:n,k2neg:o,k2:i}=a.splitScalar(e),{p:n,f:t}=this.wNAF(n),{p:i,f:r}=this.wNAF(i),n=l.constTimeNegate(s,n),i=l.constTimeNegate(o,i),i=new y(p.mul(i.px,a.beta),i.py,i.pz),u=n.add(i),t.add(r)):({p:s,f:o}=this.wNAF(e),u=s,o),y.normalizeZ([u,f])[0]}multiplyAndAddUnsafe(e,t,r){let n=y.BASE;var i=(e,t)=>t!==j&&t!==L&&e.equals(n)?e.multiply(t):e.multiplyUnsafe(t),t=i(this,t).add(i(e,r));return t.is0()?void 0:t}toAffine(e){return a(this,e)}isTorsionFree(){var{h:e,isTorsionFree:t}=h;if(e===L)return!0;if(t)return t(y,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){var{h:e,clearCofactor:t}=h;return e===L?this:t?t(y,this):this.multiplyUnsafe(h.h)}toRawBytes(e=!0){return(0,I.abool)("isCompressed",e),this.assertValidity(),t(y,this,e)}toHex(e=!0){return(0,I.abool)("isCompressed",e),T.bytesToHex(this.toRawBytes(e))}}y.BASE=new y(h.Gx,h.Gy,p.ONE),y.ZERO=new y(p.ZERO,p.ONE,p.ZERO);e=h.nBitLength;let l=(0,S.wNAF)(y,h.endo?Math.ceil(e/2):e);return{CURVE:h,ProjectivePoint:y,normPrivateKeyToScalar:o,weierstrassEquation:i,isWithinCurveOrder:function(e){return T.inRange(e,L,h.n)}}}function n(f,e){var t=f.ORDER;let r=j;for(let e=t-L;e%y===j;e/=y)r+=L;let l=r;var n=y<<l-L-L,i=n*y;let o=(t-L)/i,d=(o-L)/y,c=i-L,h=n,p=f.pow(e,o),w=f.pow(e,(o+L)/y),a=(e,t)=>{let r=p;var n=f.pow(t,c);let i=f.sqr(n);i=f.mul(i,t);var o=f.mul(e,i),o=f.pow(o,d);o=f.mul(o,n),n=f.mul(o,t),i=f.mul(o,e);let a=f.mul(i,n);o=f.pow(a,h);t=f.eql(o,f.ONE);n=f.mul(i,w),o=f.mul(a,r),i=f.cmov(n,i,t),a=f.cmov(o,a,t);for(let e=l;e>L;e--){var s=e-y,s=y<<s-L,s=f.pow(a,s),u=f.eql(s,f.ONE),n=f.mul(i,r);r=f.mul(r,r),s=f.mul(a,r),i=f.cmov(n,i,u),a=f.cmov(s,a,u)}return{isValid:t,value:i}};if(f.ORDER%s===g){let i=(f.ORDER-g)/s,o=f.sqrt(f.neg(e));a=(e,t)=>{var r=f.sqr(t),n=f.mul(e,t),r=f.mul(r,n),r=f.pow(r,i),r=f.mul(r,n),n=f.mul(r,o),t=f.mul(f.sqr(r),t),t=f.eql(t,e);return{isValid:t,value:f.cmov(n,r,t)}}}return a}},{"./curve.js":2,"./modular.js":4,"./utils.js":5}],7:[function(e,t,r){function n(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function i(e,...t){if(!((r=e)instanceof Uint8Array||ArrayBuffer.isView(r)&&"Uint8Array"===r.constructor.name))throw new Error("Uint8Array expected");var r;if(0<t.length&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function o(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");n(e.outputLen),n(e.blockLen)}function a(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function s(e,t){i(e);t=t.outputLen;if(e.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}Object.defineProperty(r,"__esModule",{value:!0}),r.anumber=n,r.number=n,r.abytes=i,r.bytes=i,r.ahash=o,r.aexists=a,r.aoutput=s,r.default={number:n,bytes:i,hash:o,exists:a,output:s}},{}],8:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.HashMD=r.Maj=r.Chi=void 0;let f=e("./_assert.js"),l=e("./utils.js");r.Chi=(e,t,r)=>e&t^~e&r;r.Maj=(e,t,r)=>e&t^e&r^t&r;class n extends l.Hash{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=(0,l.createView)(this.buffer)}update(t){(0,f.aexists)(this);var{view:r,buffer:n,blockLen:i}=this,o=(t=(0,l.toBytes)(t)).length;for(let e=0;e<o;){var a=Math.min(i-this.pos,o-e);if(a===i)for(var s=(0,l.createView)(t);i<=o-e;e+=i)this.process(s,e);else n.set(t.subarray(e,e+a),this.pos),this.pos+=a,e+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(e){(0,f.aexists)(this),(0,f.aoutput)(e,this),this.finished=!0;var{buffer:t,view:r,blockLen:n,isLE:i}=this;let o=this.pos;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(r,0),o=0);for(let e=o;e<n;e++)t[e]=0;((e,t,r,n)=>{if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);var i=BigInt(32),o=BigInt(4294967295),i=Number(r>>i&o),r=Number(r&o),o=n?0:4;e.setUint32(t+(n?4:0),i,n),e.setUint32(t+o,r,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);var a=(0,l.createView)(e),r=this.outputLen;if(r%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var s=r/4,u=this.get();if(s>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<s;e++)a.setUint32(4*e,u[e],i)}digest(){var{buffer:e,outputLen:t}=this,e=(this.digestInto(e),e.slice(0,t));return this.destroy(),e}_cloneInto(e){(e=e||new this.constructor).set(...this.get());var{blockLen:t,buffer:r,length:n,finished:i,destroyed:o,pos:a}=this;return e.length=n,e.pos=a,e.finished=i,e.destroyed=o,n%t&&e.buffer.set(r),e}}r.HashMD=n},{"./_assert.js":7,"./utils.js":12}],9:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.crypto=void 0,r.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},{}],10:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.hmac=r.HMAC=void 0;let i=e("./_assert.js"),o=e("./utils.js");class n extends o.Hash{constructor(e,t){super(),this.finished=!1,(this.destroyed=!1,i.ahash)(e);t=(0,o.toBytes)(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;var r=this.blockLen,n=new Uint8Array(r);n.set(t.length>r?e.create().update(t).digest():t);for(let e=0;e<n.length;e++)n[e]^=54;this.iHash.update(n),this.oHash=e.create();for(let e=0;e<n.length;e++)n[e]^=106;this.oHash.update(n),n.fill(0)}update(e){return(0,i.aexists)(this),this.iHash.update(e),this}digestInto(e){(0,i.aexists)(this),(0,i.abytes)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){var e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){var{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:a}=this;return(e=e||Object.create(Object.getPrototypeOf(this),{})).finished=n,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}r.HMAC=n;r.hmac=(e,t,r)=>new n(e,t).update(r).digest(),r.hmac.create=(e,t)=>new n(e,t)},{"./_assert.js":7,"./utils.js":12}],11:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.sha224=r.sha256=r.SHA256=void 0;let w=e("./_md.js"),y=e("./utils.js"),g=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),n=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),b=new Uint32Array(64);class i extends w.HashMD{constructor(){super(64,32,8,!1),this.A=0|n[0],this.B=0|n[1],this.C=0|n[2],this.D=0|n[3],this.E=0|n[4],this.F=0|n[5],this.G=0|n[6],this.H=0|n[7]}get(){var{A:e,B:t,C:r,D:n,E:i,F:o,G:a,H:s}=this;return[e,t,r,n,i,o,a,s]}set(e,t,r,n,i,o,a,s){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|a,this.H=0|s}process(t,r){for(let e=0;e<16;e++,r+=4)b[e]=t.getUint32(r,!1);for(let e=16;e<64;e++){var n=b[e-15],i=b[e-2],n=(0,y.rotr)(n,7)^(0,y.rotr)(n,18)^n>>>3,i=(0,y.rotr)(i,17)^(0,y.rotr)(i,19)^i>>>10;b[e]=i+b[e-7]+n+b[e-16]|0}let{A:o,B:a,C:s,D:u,E:f,F:l,G:d,H:c}=this;for(let e=0;e<64;e++){var h=(0,y.rotr)(f,6)^(0,y.rotr)(f,11)^(0,y.rotr)(f,25),h=c+h+(0,w.Chi)(f,l,d)+g[e]+b[e]|0,p=((0,y.rotr)(o,2)^(0,y.rotr)(o,13)^(0,y.rotr)(o,22))+(0,w.Maj)(o,a,s)|0;c=d,d=l,l=f,f=u+h|0,u=s,s=a,a=o,o=h+p|0}o=o+this.A|0,a=a+this.B|0,s=s+this.C|0,u=u+this.D|0,f=f+this.E|0,l=l+this.F|0,d=d+this.G|0,c=c+this.H|0,this.set(o,a,s,u,f,l,d,c)}roundClean(){b.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}r.SHA256=i;class o extends i{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}r.sha256=(0,y.wrapConstructor)(()=>new i),r.sha224=(0,y.wrapConstructor)(()=>new o)},{"./_md.js":8,"./utils.js":12}],12:[function(e,t,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Hash=a.nextTick=a.byteSwapIfBE=a.byteSwap=a.isLE=a.rotl=a.rotr=a.createView=a.u32=a.u8=void 0,a.isBytes=function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name},a.byteSwap32=function(t){for(let e=0;e<t.length;e++)t[e]=(0,a.byteSwap)(t[e])},a.bytesToHex=function(t){(0,s.abytes)(t);let r="";for(let e=0;e<t.length;e++)r+=n[t[e]];return r},a.hexToBytes=function(r){if("string"!=typeof r)throw new Error("hex string expected, got "+typeof r);var e=r.length,n=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);var i=new Uint8Array(n);for(let e=0,t=0;e<n;e++,t+=2){var o,a=u(r.charCodeAt(t)),s=u(r.charCodeAt(t+1));if(void 0===a||void 0===s)throw o=r[t]+r[t+1],new Error('hex string expected, got non-hex character "'+o+'" at index '+t);i[e]=16*a+s}return i},a.asyncLoop=async function(t,r,n){let i=Date.now();for(let e=0;e<t;e++){n(e);var o=Date.now()-i;0<=o&&o<r||(await(0,a.nextTick)(),i+=o)}},a.utf8ToBytes=o,a.toBytes=f,a.concatBytes=function(...r){let t=0;for(let e=0;e<r.length;e++){var n=r[e];(0,s.abytes)(n),t+=n.length}var i=new Uint8Array(t);for(let e=0,t=0;e<r.length;e++){var o=r[e];i.set(o,t),t+=o.length}return i},a.checkOpts=function(e,t){if(void 0!==t&&"[object Object]"!=={}.toString.call(t))throw new Error("Options should be object or undefined");e=Object.assign(e,t);return e},a.wrapConstructor=function(t){var e=e=>t().update(f(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e},a.wrapConstructorWithOpts=function(r){var e=(e,t)=>r(t).update(f(e)).digest(),t=r({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=e=>r(e),e},a.wrapXOFConstructorWithOpts=function(r){var e=(e,t)=>r(t).update(f(e)).digest(),t=r({});return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=e=>r(e),e},a.randomBytes=function(e=32){if(r.crypto&&"function"==typeof r.crypto.getRandomValues)return r.crypto.getRandomValues(new Uint8Array(e));if(r.crypto&&"function"==typeof r.crypto.randomBytes)return r.crypto.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")};let r=e("@noble/hashes/crypto"),s=e("./_assert.js");a.u8=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a.u32=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),a.createView=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),a.rotr=(e,t)=>e<<32-t|e>>>t,a.rotl=(e,t)=>e<<t|e>>>32-t>>>0,a.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];a.byteSwap=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255,a.byteSwapIfBE=a.isLE?e=>e:e=>(0,a.byteSwap)(e);let n=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));let i={_0:48,_9:57,A:65,F:70,a:97,f:102};function u(e){return e>=i._0&&e<=i._9?e-i._0:e>=i.A&&e<=i.F?e-(i.A-10):e>=i.a&&e<=i.f?e-(i.a-10):void 0}function o(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function f(e){return"string"==typeof e&&(e=o(e)),(0,s.abytes)(e),e}a.nextTick=async()=>{};a.Hash=class{clone(){return this._cloneInto()}}},{"./_assert.js":7,"@noble/hashes/crypto":9}],13:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.encodeToCurve=r.hashToCurve=r.schnorr=r.secp256k1=void 0;let i=e("@noble/hashes/sha256"),s=e("@noble/hashes/utils");var n=e("./_shortw_utils.js");let o=e("./abstract/hash-to-curve.js"),c=e("./abstract/modular.js"),u=e("./abstract/utils.js"),a=e("./abstract/weierstrass.js"),h=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),d=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),p=BigInt(1),w=BigInt(2),y=(e,t)=>(e+t/w)/t;function f(e){var t=h,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),a=BigInt(23),s=BigInt(44),u=BigInt(88),f=e*e*e%t,l=f*f*e%t,d=(0,c.pow2)(l,r,t)*l%t,d=(0,c.pow2)(d,r,t)*l%t,d=(0,c.pow2)(d,w,t)*f%t,i=(0,c.pow2)(d,i,t)*d%t,d=(0,c.pow2)(i,o,t)*i%t,o=(0,c.pow2)(d,s,t)*d%t,u=(0,c.pow2)(o,u,t)*o%t,o=(0,c.pow2)(u,s,t)*d%t,u=(0,c.pow2)(o,r,t)*l%t,s=(0,c.pow2)(u,a,t)*i%t,d=(0,c.pow2)(s,n,t)*f%t,o=(0,c.pow2)(d,w,t);if(g.eql(g.sqr(o),e))return o;throw new Error("Cannot find square root")}let g=(0,c.Field)(h,void 0,void 0,{sqrt:f}),l=(r.secp256k1=(0,n.createCurve)({a:BigInt(0),b:BigInt(7),Fp:g,n:d,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{var t=d,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-p*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,a=BigInt("0x100000000000000000000000000000000"),s=y(o*e,t),u=y(-n*e,t);let f=(0,c.mod)(e-s*r-u*i,t),l=(0,c.mod)(-s*n-u*o,t);r=f>a,i=l>a;if(r&&(f=t-f),i&&(l=t-l),f>a||l>a)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:r,k1:f,k2neg:i,k2:l}}}},i.sha256),BigInt(0)),b={};function m(e,...t){let r=b[e];var n;return void 0===r&&(n=(0,i.sha256)(Uint8Array.from(e,e=>e.charCodeAt(0))),r=(0,u.concatBytes)(n,n),b[e]=r),(0,i.sha256)((0,u.concatBytes)(r,...t))}let v=e=>e.toRawBytes(!0).slice(1),E=e=>(0,u.numberToBytesBE)(e,32),B=e=>(0,c.mod)(e,h),x=e=>(0,c.mod)(e,d),A=r.secp256k1.ProjectivePoint,S=(e,t,r)=>A.BASE.multiplyAndAddUnsafe(e,t,r);function O(e){var e=r.secp256k1.utils.normPrivateKeyToScalar(e),t=A.fromPrivateKey(e);return{scalar:t.hasEvenY()?e:x(-e),bytes:v(t)}}function T(e){(0,u.aInRange)("x",e,p,h);var t=B(e*e);let r=f(B(t*e+BigInt(7)));r%w!==l&&(r=B(-r));t=new A(e,r,p);return t.assertValidity(),t}let I=u.bytesToNumberBE;function R(...e){return x(I(m("BIP0340/challenge",...e)))}function j(e,t,r){e=(0,u.ensureBytes)("signature",e,64),t=(0,u.ensureBytes)("message",t),r=(0,u.ensureBytes)("publicKey",r,32);try{var n,i,o,a=T(I(r)),s=I(e.subarray(0,32));return(0,u.inRange)(s,p,h)?(n=I(e.subarray(32,64)),!(!(0,u.inRange)(n,p,d)||(i=R(E(s),v(a),t),!(o=S(a,n,x(-i))))||!o.hasEvenY()||o.toAffine().x!==s)):!1}catch(e){return!1}}r.schnorr={getPublicKey:function(e){return O(e).bytes},sign:function(e,t,r=(0,s.randomBytes)(32)){var e=(0,u.ensureBytes)("message",e),{bytes:t,scalar:n}=O(t),r=(0,u.ensureBytes)("auxRand",r,32),r=E(n^I(m("BIP0340/aux",r))),r=m("BIP0340/nonce",r,t,e);if((r=x(I(r)))===l)throw new Error("sign failed: k is zero");var{bytes:r,scalar:i}=O(r),o=R(r,t,e),a=new Uint8Array(64);if(a.set(r,0),a.set(E(x(i+o*n)),32),j(a,e,t))return a;throw new Error("sign: Invalid signature produced")},verify:j,utils:{randomPrivateKey:r.secp256k1.utils.randomPrivateKey,lift_x:T,pointToBytes:v,numberToBytesBE:u.numberToBytesBE,bytesToNumberBE:u.bytesToNumberBE,taggedHash:m,mod:c.mod}};let L=(()=>(0,o.isogenyMap)(g,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(e=>BigInt(e)))))(),k=(()=>(0,a.mapToCurveSimpleSWU)(g,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:g.create(BigInt("-11"))}))(),_=(()=>(0,o.createHasher)(r.secp256k1.ProjectivePoint,e=>{var{x:e,y:t}=k(g.create(e[0]));return L(e,t)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:g.ORDER,m:1,k:128,expand:"xmd",hash:i.sha256}))();r.hashToCurve=_.hashToCurve,r.encodeToCurve=_.encodeToCurve},{"./_shortw_utils.js":1,"./abstract/hash-to-curve.js":3,"./abstract/modular.js":4,"./abstract/utils.js":5,"./abstract/weierstrass.js":6,"@noble/hashes/sha256":11,"@noble/hashes/utils":12}],secp256k1:[function(e,H,t){var o=e("@noble/curves/secp256k1"),r=e("@noble/curves/abstract/modular"),e=e("@noble/curves/abstract/utils");function n(r){var n=Object.create(null);return r&&Object.keys(r).forEach(function(e){var t;"default"!==e&&(t=Object.getOwnPropertyDescriptor(r,e),Object.defineProperty(n,e,t.get?t:{enumerable:!0,get:function(){return r[e]}}))}),n.default=r,Object.freeze(n)}var i=n(r),a=n(e);let s=o.secp256k1.ProjectivePoint,u="Expected Private",f="Expected Point",l="Expected Tweak",d="Expected Signature",c="Expected Extra Data (32 bytes)",h="Expected Scalar",p=32,P=32,w=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65]),q=32,C=new Uint8Array(32),F=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,69,81,35,25,80,183,95,196,64,45,161,114,47,201,186,238]),D=BigInt(1);function y(t,r){for(let e=0;e<32;++e)if(t[e]!==r[e])return t[e]<r[e]?-1:1;return 0}function g(e){return 0===y(e,C)}function b(e){return e instanceof Uint8Array&&e.length===P&&!(0<=y(e,w))}function m(e){return e instanceof Uint8Array&&64===e.length&&y(e.subarray(0,32),w)<0&&y(e.subarray(32,64),w)<0}function M(e){return e instanceof Uint8Array&&64===e.length&&y(e.subarray(0,32),F)<0}function v(e){return e instanceof Uint8Array&&e.length===p}function E(e){return void 0===e||e instanceof Uint8Array&&e.length===q}function B(e){let t;if("bigint"==typeof e)t=e;else if("number"==typeof e&&Number.isSafeInteger(e)&&0<=e)t=BigInt(e);else if("string"==typeof e){if(64!==e.length)throw new Error("Expected 32 bytes of private scalar");t=a.hexToNumber(e)}else{if(!(e instanceof Uint8Array))throw new TypeError("Expected valid private scalar");if(32!==e.length)throw new Error("Expected 32 bytes of private scalar");t=a.bytesToNumberBE(e)}if(t<0)throw new Error("Expected private scalar >= 0");return t}function x(e){return o.secp256k1.utils.normPrivateKeyToScalar(e)}function A(e,t,r){e=I(e),t=B(t),e=s.BASE.multiplyAndAddUnsafe(e,t,D);if(e)return e.toRawBytes(r);throw new Error("Tweaked point at infinity")}function S(e,t){return void 0===e?void 0===t||L(t):!!e}function O(e){try{return e()}catch(e){return null}}function T(e){return o.schnorr.utils.lift_x(a.bytesToNumberBE(e))}function I(e){return 32===e.length?T(e):s.fromHex(e)}function R(e,t){if(32===e.length!==t)return!1;try{return t?!!T(e):!!s.fromHex(e)}catch(e){return!1}}function j(e){return R(e,!1)}function L(e){return R(e,!1)&&33===e.length}function k(e){return o.secp256k1.utils.isValidPrivateKey(e)}function _(e){return R(e,!0)}function U(e){if(j(e))return e.slice(1,33);throw new Error(f)}function N(e,t){if(k(e))return O(()=>o.secp256k1.getPublicKey(e,S(t)));throw new Error(u)}t.isPoint=j,t.isPointCompressed=L,t.isPrivate=k,t.isXOnlyPoint=_,t.pointAdd=function(r,n,i){if(j(r)&&j(n))return O(()=>{var e=I(r),t=I(n);return e.equals(t.negate())?null:e.add(t).toRawBytes(S(i,r))});throw new Error(f)},t.pointAddScalar=function(e,t,r){if(!j(e))throw new Error(f);if(b(t))return O(()=>A(e,t,S(r,e)));throw new Error(l)},t.pointCompress=function(e,t){if(j(e))return I(e).toRawBytes(S(t,e));throw new Error(f)},t.pointFromScalar=N,t.pointMultiply=function(n,i,o){if(!j(n))throw new Error(f);if(b(i))return O(()=>{return t=i,r=S(o,e=n),e=I(e),t="string"==typeof t?t:a.bytesToHex(t),t=a.hexToNumber(t),e.multiply(t).toRawBytes(r);var e,t,r});throw new Error(l)},t.privateAdd=function(r,n){if(!k(r))throw new Error(u);if(b(n))return O(()=>{return t=n,e=x(e=r),t=B(t),e=a.numberToBytesBE(i.mod(e+t,o.secp256k1.CURVE.n),32),o.secp256k1.utils.isValidPrivateKey(e)?e:null;var e,t});throw new Error(l)},t.privateNegate=function(e){if(k(e))return e=x(e=e),e=a.numberToBytesBE(o.secp256k1.CURVE.n-e,32),o.secp256k1.utils.isValidPrivateKey(e)?e:null;throw new Error(u)},t.privateSub=function(r,n){if(!k(r))throw new Error(u);if(b(n))return O(()=>{return t=n,e=x(e=r),t=B(t),e=a.numberToBytesBE(i.mod(e-t,o.secp256k1.CURVE.n),32),o.secp256k1.utils.isValidPrivateKey(e)?e:null;var e,t});throw new Error(l)},t.recover=function(e,t,r,n){if(!v(e))throw new Error("Expected Hash");if(m(t)&&!g((i=t).subarray(0,32))&&!g(i.subarray(32,64))){if(2&r&&!M(t))throw new Error("Bad Recovery Id");if(_(t.subarray(0,32))){var i=o.secp256k1.Signature.fromCompact(t).addRecoveryBit(r).recoverPublicKey(e);if(i)return i.toRawBytes(S(n))}}throw new Error(d)},t.sign=function(e,t,r){if(!k(t))throw new Error(u);if(!v(e))throw new Error(h);if(E(r))return o.secp256k1.sign(e,t,{extraEntropy:r}).toCompactRawBytes();throw new Error(c)},t.signRecoverable=function(e,t,r){if(!k(t))throw new Error(u);if(!v(e))throw new Error(h);if(E(r))return{signature:(e=o.secp256k1.sign(e,t,{extraEntropy:r})).toCompactRawBytes(),recoveryId:e.recovery};throw new Error(c)},t.signSchnorr=function(e,t,r){if(!k(t))throw new Error(u);if(!v(e))throw new Error(h);if(E(r))return o.schnorr.sign(e,t,r);throw new Error(c)},t.verify=function(e,t,r,n){if(!j(t))throw new Error(f);if(!m(r))throw new Error(d);if(v(e))return o.secp256k1.verify(r,e,t,{lowS:n});throw new Error(h)},t.verifySchnorr=function(e,t,r){if(!_(t))throw new Error(f);if(!m(r))throw new Error(d);if(v(e))return o.schnorr.verify(r,e,t);throw new Error(h)},t.xOnlyPointAddTweak=function(t,r){if(!_(t))throw new Error(f);if(b(r))return O(()=>{var e=A(t,r,!0);return{parity:e[0]%2==1?1:0,xOnlyPubkey:e.slice(1)}});throw new Error(l)},t.xOnlyPointFromPoint=U,t.xOnlyPointFromScalar=function(e){if(k(e))return U(N(e));throw new Error(u)}},{"@noble/curves/abstract/modular":4,"@noble/curves/abstract/utils":5,"@noble/curves/secp256k1":13}]},{},[])("secp256k1")});